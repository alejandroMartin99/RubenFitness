<div class="water-card-expanded" [class.completed]="isGoalCompleted()">
  <!-- Header Top Row -->
  <div class="water-header-row">
    <!-- Motivational Message Left -->
    <div class="water-motivational-message-left">
      {{ getMotivationalMessage() }}
    </div>
    <!-- Compact Header Top Right -->
    <div class="water-header-compact-top">
      <div class="water-icon-wrapper-small">
        <mat-icon class="water-icon">water_drop</mat-icon>
      </div>
      <div class="water-value-small">{{ (waterDrunk / 1000).toFixed(1) }}L</div>
      <div class="water-goal-small">/ {{ (waterGoal / 1000).toFixed(1) }}L</div>
    </div>
  </div>
  
  <!-- Water History Chart (Bars) -->
  <div class="water-history-compact">
    <div class="history-header-compact">
      <span class="history-label-compact">Últimos 7 días</span>
      <span class="history-average-compact" *ngIf="getAverageWater() > 0">{{ (getAverageWater() / 1000).toFixed(1) }}L avg</span>
    </div>
    <div class="water-bars-compact">
      <div *ngFor="let day of waterHistory; let i = index" class="water-bar-compact">
        <div class="bar-compact" [style.height.px]="getWaterBarHeight(day.water_ml)" [class.has-data]="day.water_ml > 0"></div>
        <span class="bar-label-compact">{{ i === waterHistory.length - 1 ? 'Hoy' : (waterHistory.length - 1 - i) }}</span>
      </div>
    </div>
  </div>
  
  <!-- Add Water Button -->
  <button mat-raised-button color="primary" class="add-water-btn-compact" (click)="addWater()">
    <mat-icon>add</mat-icon>
    Añadir 200ml
  </button>
  
  <!-- Water Marks (10 dots) -->
  <div class="water-marks-grid">
    <div
      *ngFor="let mark of [1,2,3,4,5,6,7,8,9,10]"
      class="water-dot"
      [class.filled]="waterGlasses >= mark"
    ></div>
  </div>
</div>

