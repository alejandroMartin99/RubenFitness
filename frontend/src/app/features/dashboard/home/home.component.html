<!-- USER/TESTER DASHBOARD -->
<div class="home-container" *ngIf="!isAdmin">
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">
        Welcome back, <span class="text-gradient">{{ user?.fullName || user?.email }}</span>
      </h1>
      <p class="hero-subtitle">Ready to crush your fitness goals today?</p>
    </div>
  </div>

  <!-- Daily Workout Panel -->
  <!-- Daily Workout Panel removed -->

  <!-- Daily Progress Indicators -->
  <div class="progress-indicators">
    <h2 class="section-title">Today's Progress</h2>
    <div class="indicators-grid">
      <!-- Workout Calendar Compact -->
      <app-workout-calendar-compact [user]="user"></app-workout-calendar-compact>

      <!-- Water Tracking Card -->
      <app-water-tracking [user]="user"></app-water-tracking>

      <!-- Sleep Tracking Card -->
      <app-sleep-tracking [user]="user"></app-sleep-tracking>
    </div>
  </div>

  <!-- Feature Cards Grid -->
  <div class="cards-grid">
    <mat-card class="feature-card">
      <div class="card-image-container">
        <div class="card-image" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06)), url('https://images.pexels.com/photos/414029/pexels-photo-414029.jpeg?auto=compress&cs=tinysrgb&w=1600');"></div>
        <div class="card-overlay"></div>
        <div class="card-icon">
          <mat-icon>bar_chart</mat-icon>
        </div>
      </div>
      <mat-card-content>
        <h2>Your Progress</h2>
        <p>Track your fitness journey with detailed analytics. Monitor strength gains, body measurements, and consistency.</p>
        <button mat-raised-button color="primary" class="feature-button" routerLink="/progress">
          <mat-icon>arrow_forward</mat-icon>
          View Progress
        </button>
      </mat-card-content>
    </mat-card>

    <mat-card class="feature-card">
      <div class="card-image-container">
        <div class="card-image" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06)), url('https://images.pexels.com/photos/1552242/pexels-photo-1552242.jpeg?auto=compress&cs=tinysrgb&w=1600');"></div>
        <div class="card-overlay"></div>
        <div class="card-icon">
          <mat-icon>psychology</mat-icon>
        </div>
      </div>
      <mat-card-content>
        <h2>AI Assistant</h2>
        <p>Get personalized fitness advice from Rubén. Chat about workouts, nutrition, and motivation anytime.</p>
        <button mat-raised-button color="primary" class="feature-button" routerLink="/assistant">
          <mat-icon>arrow_forward</mat-icon>
          Start Chat
        </button>
      </mat-card-content>
    </mat-card>

    <mat-card class="feature-card">
      <div class="card-image-container">
        <div class="card-image" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06)), url('https://images.pexels.com/photos/1640777/pexels-photo-1640777.jpeg?auto=compress&cs=tinysrgb&w=1600');"></div>
        <div class="card-overlay"></div>
        <div class="card-icon">
          <mat-icon>restaurant_menu</mat-icon>
        </div>
      </div>
      <mat-card-content>
        <h2>Plan Nutricional</h2>
        <p>Tu dieta personalizada por tu coach. Consulta tus comidas, macros y chatea directamente.</p>
        <button mat-raised-button color="primary" class="feature-button" routerLink="/nutrition">
          <mat-icon>arrow_forward</mat-icon>
          Ver mi plan
        </button>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Stats Section -->
  <div class="stats-section">
    <h2 class="section-title">Your Fitness Stats</h2>
    <div class="stats-grid" *ngIf="stats">
      <div class="stat-card">
        <div class="stat-icon">
          <mat-icon>calendar_today</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ stats.daysActive !== null ? stats.daysActive : '-' }}</div>
          <div class="stat-label">Days Active (mes)</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <mat-icon>check_circle</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">
            <ng-container *ngIf="stats.workoutsWeek !== null; else dash">{{ stats.workoutsWeek }}</ng-container>
            /
            <ng-container *ngIf="stats.weeklyTarget !== null; else dash">{{ stats.weeklyTarget }}</ng-container>
          </div>
          <div class="stat-label">Workouts esta semana</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <mat-icon>trending_up</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">
            {{ stats.goalCompletion !== null ? (stats.goalCompletion + '%') : '-' }}
          </div>
          <div class="stat-label">Cumplimiento semanal</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <mat-icon>schedule</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ stats.lastWorkout || '-' }}</div>
          <div class="stat-label">Último entreno</div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #dash>-</ng-template>
</div>

<!-- ADMIN/COACH DASHBOARD -->
<div class="home-container" *ngIf="isAdmin">
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">
        Coach Dashboard, <span class="text-gradient">{{ user?.fullName || 'Rubén' }}</span>
      </h1>
      <p class="hero-subtitle">Manage your clients and track their progress</p>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="stats-section">
    <h2 class="section-title">Overview</h2>
    <div class="stats-grid">
      <div class="stat-card admin-stat">
        <div class="stat-icon">
          <mat-icon>people</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">24</div>
          <div class="stat-label">Active Clients</div>
        </div>
      </div>
      <div class="stat-card admin-stat">
        <div class="stat-icon">
          <mat-icon>check_circle</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">87%</div>
          <div class="stat-label">Completion Rate</div>
        </div>
      </div>
      <div class="stat-card admin-stat">
        <div class="stat-icon">
          <mat-icon>warning</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">3</div>
          <div class="stat-label">At Risk</div>
        </div>
      </div>
      <div class="stat-card admin-stat">
        <div class="stat-icon">
          <mat-icon>trending_up</mat-icon>
        </div>
        <div class="stat-content">
          <div class="stat-value">12%</div>
          <div class="stat-label">Growth</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Feature Cards Grid -->
  <div class="cards-grid">
    <mat-card class="feature-card">
      <div class="card-image-container">
        <div class="card-image" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06)), url('https://images.pexels.com/photos/3861958/pexels-photo-3861958.jpeg?auto=compress&cs=tinysrgb&w=1600');"></div>
        <div class="card-overlay"></div>
        <div class="card-icon">
          <mat-icon>people_outline</mat-icon>
        </div>
      </div>
      <mat-card-content>
        <h2>Client Management</h2>
        <p>View and manage all your clients. Filter by activity level, progress, and risk of abandonment.</p>
        <button mat-raised-button color="primary" class="feature-button" routerLink="/coach">
          <mat-icon>arrow_forward</mat-icon>
          Manage Clients
        </button>
      </mat-card-content>
    </mat-card>

    <mat-card class="feature-card">
      <div class="card-image-container">
        <div class="card-image" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06)), url('https://images.pexels.com/photos/7988079/pexels-photo-7988079.jpeg?auto=compress&cs=tinysrgb&w=1600');"></div>
        <div class="card-overlay"></div>
        <div class="card-icon">
          <mat-icon>chat_bubble_outline</mat-icon>
        </div>
      </div>
      <mat-card-content>
        <h2>Automated Messages</h2>
        <p>AI-generated motivational messages. Quick response templates for personalized communication.</p>
        <button mat-raised-button color="primary" class="feature-button" routerLink="/coach">
          <mat-icon>arrow_forward</mat-icon>
          View Messages
        </button>
      </mat-card-content>
    </mat-card>

    <mat-card class="feature-card">
      <div class="card-image-container">
        <div class="card-image" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.06), rgba(0,0,0,0.06)), url('https://images.pexels.com/photos/618833/pexels-photo-618833.jpeg?auto=compress&cs=tinysrgb&w=1600');"></div>
        <div class="card-overlay"></div>
        <div class="card-icon">
          <mat-icon>share</mat-icon>
        </div>
      </div>
      <mat-card-content>
        <h2>Social Content</h2>
        <p>Generate achievement images and progress posts. Ready-to-share content for testimonials.</p>
        <button mat-raised-button color="primary" class="feature-button" routerLink="/coach">
          <mat-icon>arrow_forward</mat-icon>
          Generate Content
        </button>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Recent Activity -->
  <div class="activity-section">
    <h2 class="section-title">Recent Activity</h2>
    <mat-card class="activity-card">
      <mat-card-content>
        <div class="activity-list">
          <div class="activity-item">
            <div class="activity-icon">
              <mat-icon>check_circle</mat-icon>
            </div>
            <div class="activity-content">
              <strong>John Doe</strong> completed today's workout
              <span class="activity-time">2 hours ago</span>
            </div>
          </div>
          <div class="activity-item">
            <div class="activity-icon warning">
              <mat-icon>warning</mat-icon>
            </div>
            <div class="activity-content">
              <strong>Sarah Smith</strong> missed 3 consecutive workouts
              <span class="activity-time">4 hours ago</span>
            </div>
          </div>
          <div class="activity-item">
            <div class="activity-icon">
              <mat-icon>emoji_events</mat-icon>
            </div>
            <div class="activity-content">
              <strong>Mike Johnson</strong> reached a new PR!
              <span class="activity-time">6 hours ago</span>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
